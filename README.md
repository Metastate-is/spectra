# Spectra Project Documentation

## Оглавление
- [Введение](#введение)
- [Цели проекта](#цели-проекта)
- [Архитектура](#архитектура)
- [Быстрый старт](#быстрый-старт)
- [Структура проекта](#структура-проекта)
- [Конфигурация](#конфигурация)
- [Скрипты и команды](#скрипты-и-команды)
- [Лучшие практики](#лучшие-практики)
- [Взаимодействие и расширение](#взаимодействие-и-расширение)
- [Контакты и поддержка](#контакты-и-поддержка)

---

## Введение
Spectra — это backend-проект на базе NestJS, предназначенный для построения масштабируемых, отказоустойчивых и интегрируемых микросервисных решений с поддержкой телеметрии, кэширования, распределённых вычислений и работы с блокчейн/графовыми БД.

## Цели проекта
- Обеспечить гибкую платформу для интеграции с внешними сервисами (Kafka, gRPC, Redis, Neo4j, EVM).
- Внедрить стандарты качества кода, логирования и мониторинга.
- Автоматизировать деплой смарт-контрактов и взаимодействие с блокчейном.
- Обеспечить удобную CLI для управления и администрирования.

## Архитектура
- **NestJS** — основной backend-фреймворк.
- **Kafka** — брокер сообщений для событийной архитектуры.
- **Redis** — кэш и быстрый стор.
- **Neo4j** — графовая база для сложных связей.
- **gRPC** — высокопроизводительная RPC-коммуникация.
- **EVM/Hardhat** — интеграция со смарт-контрактами.
- **OpenTelemetry + Prometheus** — метрики и трассировка.
- **Pino** — структурированное логирование.

## Быстрый старт
1. **Установка зависимостей:**
   ```bash
   npm install
   ```
2. **Конфигурируйте переменные окружения:**
   Скопируйте `.env.example` в `.env` и заполните значения.
   ```bash
   cp .env.example .env
   # Редактируйте .env
   ```
3. **Запуск приложения:**
   ```bash
   npm run start:dev
   ```
4. **Тесты:**
   ```bash
   npm test
   ```

## Структура проекта
```
artifacts/           # Сборки контрактов
cache/               # Кэш сборки
contracts/           # Исходники смарт-контрактов
src/                 # Исходный код приложения
  core/              # Базовые сервисы (логгер, кэш, телеметрия, Kafka, Redis, Neo4j)
  modules/           # Бизнес-логика и модули
  config/            # Конфигурация
  main.ts            # Точка входа
  app.module.ts      # Главный модуль
scripts/             # Скрипты деплоя и утилиты
helm/                # Helm charts для Kubernetes
```

## Конфигурация
- Все переменные окружения описаны в `.env.example`.
- Основные параметры: подключения к БД, Kafka, Redis, gRPC, параметры смарт-контрактов.
- Для продакшена используйте отдельный `.env` с секретами.

## Скрипты и команды
- `npm run start:dev` — запуск в dev-режиме
- `npm run build` — сборка
- `npm run test` — юнит-тесты
- `npm run lint` — статический анализ
- `npm run format` — автоформатирование
- `npm run cli` — запуск CLI
- `npm run metastate:deploy` — деплой смарт-контрактов

## Лучшие практики
- Соблюдайте SOLID, DRY, KISS.
- Используйте структурированное логирование через Pino.
- Покрывайте код тестами (Jest).
- Используйте миграции и версионирование схемы данных.
- Не храните секреты в репозитории.
- Для всех внешних интеграций используйте отдельные модули.
- Следите за покрытием кода и метриками (Prometheus, OpenTelemetry).
- Для production — включайте healthchecks и мониторинг.

## Взаимодействие и расширение
- Добавляйте новые модули через NestJS CLI или вручную в директории `modules`.
- Для интеграции с внешними сервисами используйте DI и отдельные сервисы.
- Для расширения CLI — добавляйте команды в `src/cli`.
- Для деплоя смарт-контрактов используйте скрипты в `scripts/` и Hardhat.

## Контакты и поддержка
- Автор: Perov David
- Вопросы и баги: через Issues в репозитории
- Для корпоративной поддержки — обратитесь к владельцу проекта
